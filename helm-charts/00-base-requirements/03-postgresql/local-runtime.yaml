# PostgreSQL Cloud Pirates - Essential Configuration

# Official PostgreSQL 16.0 image from Docker Hub
image:
  registry: docker.io
  repository: postgres
  tag: "16.0"
  imagePullPolicy: IfNotPresent

# References Kubernetes secret: postgres-password
auth:
  existingSecret: "postgres-password"
  secretKeys:
    adminPasswordKey: "postgres-password"

# Required environment variables for official PostgreSQL image
env:
  - name: POSTGRES_PASSWORD
    valueFrom:
      secretKeyRef:
        name: postgres-password
        key: postgres-password
  - name: PGDATA
    value: /var/lib/postgresql/data/pgdata

service:
  type: ClusterIP
  port: 5432

# IBM Cloud VPC block storage
persistence:
  enabled: true
  storageClass: "ibmc-vpc-block-general-purpose"
  size: 10Gi
  accessModes:
  - ReadWriteOnce

resources:
  limits:
    cpu: 1000m
    memory: 2Gi
  requests:
    cpu: 100m
    memory: 1Gi

# Wait 30s before first liveness check to allow initialization
livenessProbe:
  enabled: true
  initialDelaySeconds: 30
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 6

readinessProbe:
  enabled: true
  initialDelaySeconds: 10
  periodSeconds: 10
  timeoutSeconds: 5
  failureThreshold: 6
