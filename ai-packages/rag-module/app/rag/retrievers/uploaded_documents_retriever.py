from typing import List

from langchain.schema import Document
from langchain_core.callbacks.manager import CallbackManagerForRetrieverRun
from langchain_core.retrievers import BaseRetriever
from opensearchpy import OpenSearch

from app.utils.llm import embedding


class OpenSearchUploadedDocumentsRetriever(BaseRetriever):
    """Retriever that uses OpenSearch's store for retrieving uploaded documents."""

    opensearch_host: str
    grpc_host: str
    virtual_host: str
    uploaded_documents_index: str
    user_id: str
    chat_id: str
    search_text: str

    def _get_relevant_documents(
        self, query: str, *, run_manager: CallbackManagerForRetrieverRun
    ) -> List[Document]:
        open_search_client = OpenSearch(
            hosts=[self.opensearch_host],
        )

        document = {
            "text": self.search_text,
        }

        embedded_query = embedding(
            grpc_host=self.grpc_host,
            virtual_host=self.virtual_host,
            openserach_host=self.opensearch_host,
            document=document,
        )

        vector_query = embedded_query[0].get("vector")

        print(embedded_query)

        documents = []

        if open_search_client.indices.exists(index=self.uploaded_documents_index):
            open_search_query = {
                "query": {
                    "hybrid": {
                        "queries": [
                            {"knn": {"vector": {"vector": vector_query, "k": 10}}},
                            {"match": {"chunkText": self.search_text}},
                        ]
                    }
                },
                "post_filter": {
                    "bool": {
                        "filter": [
                            {"term": {"user_id.keyword": self.user_id}},
                            {"term": {"chat_id.keyword": self.chat_id}},
                        ]
                    }
                },
            }

            # {
            #     "query": {
            #         "hybrid": {
            #             "queries": [
            #                 {
            #                     "knn": {
            #                         "vector": {
            #                             "vector": [
            #                                 0.018055353313684464,
            #                                 -0.04173899441957474,
            #                                 0.016461500898003578,
            #                                 -0.015228756703436375,
            #                                 -0.061861373484134674,
            #                                 0.005780825857073069,
            #                                 -0.031080109998583794,
            #                                 0.030582033097743988,
            #                                 0.009830828756093979,
            #                                 -0.061861373484134674,
            #                                 -0.015577411279082298,
            #                                 -0.05648212507367134,
            #                                 -0.03885013982653618,
            #                                 -0.008903156965970993,
            #                                 0.007271949201822281,
            #                                 -0.006854807958006859,
            #                                 -0.06126368045806885,
            #                                 0.009469721466302872,
            #                                 -0.02217695489525795,
            #                                 -0.021890558302402496,
            #                                 0.014979717321693897,
            #                                 0.010422296822071075,
            #                                 -0.06788812577724457,
            #                                 0.026721922680735588,
            #                                 0.014369570650160313,
            #                                 0.029536066576838493,
            #                                 -0.0011377985356375575,
            #                                 -0.003237511496990919,
            #                                 0.017270879819989204,
            #                                 0.01479293778538704,
            #                                 0.036558978259563446,
            #                                 -0.018814923241734505,
            #                                 -0.027543751522898674,
            #                                 -0.0001392091071465984,
            #                                 -0.010372488759458065,
            #                                 -0.05274653434753418,
            #                                 -0.041963130235672,
            #                                 -0.0057216789573431015,
            #                                 -0.015129140578210354,
            #                                 -0.05468904227018356,
            #                                 0.014917457476258278,
            #                                 -0.056133467704057693,
            #                                 0.0324249230325222,
            #                                 0.008853348903357983,
            #                                 0.03302261605858803,
            #                                 -0.035363588482141495,
            #                                 -0.0062571135349571705,
            #                                 -0.028415389358997345,
            #                                 0.008865800686180592,
            #                                 0.015577411279082298,
            #                                 0.04129072278738022,
            #                                 0.03322184830904007,
            #                                 0.0005591711378656328,
            #                                 0.07062756270170212,
            #                                 0.0045574200339615345,
            #                                 -0.052895959466695786,
            #                                 0.056133467704057693,
            #                                 -0.007340434938669205,
            #                                 -0.014655965380370617,
            #                                 -0.00948217324912548,
            #                                 -0.0009222238440997899,
            #                                 0.013111921958625317,
            #                                 0.0043363976292312145,
            #                                 -0.004806459415704012,
            #                                 -0.05747828260064125,
            #                                 -0.023198015987873077,
            #                                 0.008100004866719246,
            #                                 -0.022986331954598427,
            #                                 -0.03715667128562927,
            #                                 0.036260128021240234,
            #                                 -0.005401040893048048,
            #                                 -0.007496084552258253,
            #                                 0.06335560977458954,
            #                                 0.020583102479577065,
            #                                 -0.006499927025288343,
            #                                 0.00609835097566247,
            #                                 0.013385864906013012,
            #                                 0.050804026424884796,
            #                                 -0.034267812967300415,
            #                                 -0.003203268628567457,
            #                                 0.004934092052280903,
            #                                 0.006042317021638155,
            #                                 -0.005559803452342749,
            #                                 0.01996050402522087,
            #                                 0.012837978079915047,
            #                                 -0.02504090592265129,
            #                                 -0.030432607978582382,
            #                                 -0.025900091975927353,
            #                                 0.019375260919332504,
            #                                 -0.011462036520242691,
            #                                 -0.04831363260746002,
            #                                 0.014294859021902084,
            #                                 -0.0362103208899498,
            #                                 -0.003866335842758417,
            #                                 0.050032004714012146,
            #                                 -0.018055353313684464,
            #                                 -0.003953499719500542,
            #                                 0.0038787878584116697,
            #                                 0.03521416336297989,
            #                                 0.002831266028806567,
            #                                 0.004417335614562035,
            #                                 -0.03566243499517441,
            #                                 0.05097835510969162,
            #                                 -0.008971642702817917,
            #                                 -0.019562041386961937,
            #                                 0.023795709013938904,
            #                                 -0.008124908432364464,
            #                                 -0.060865215957164764,
            #                                 -0.014444282278418541,
            #                                 -0.014830293133854866,
            #                                 0.03147857263684273,
            #                                 -0.020147282630205154,
            #                                 0.026323460042476654,
            #                                 0.0624590702354908,
            #                                 0.028938371688127518,
            #                                 -0.02438095211982727,
            #                                 0.046296413987874985,
            #                                 -0.024654895067214966,
            #                                 -0.0031347828917205334,
            #                                 -0.017793862149119377,
            #                                 0.01832929626107216,
            #                                 0.03013376146554947,
            #                                 -0.007919451221823692,
            #                                 0.021018920466303825,
            #                                 -0.008579405955970287,
            #                                 -0.000831947079859674,
            #                                 -0.01798064075410366,
            #                                 0.07311795651912689,
            #                                 0.03180232644081116,
            #                                 -0.043083809316158295,
            #                                 0.009787246584892273,
            #                                 -0.01865304820239544,
            #                                 -0.014905004762113094,
            #                                 -0.025240138173103333,
            #                                 0.027419231832027435,
            #                                 0.04139034077525139,
            #                                 -0.0003011819499079138,
            #                                 -0.015627218410372734,
            #                                 -0.007402694784104824,
            #                                 0.03379464149475098,
            #                                 -0.0038694487884640694,
            #                                 0.022475801408290863,
            #                                 -0.009650275111198425,
            #                                 0.02282445691525936,
            #                                 -0.00402821134775877,
            #                                 -0.008367721922695637,
            #                                 -0.013111921958625317,
            #                                 0.04158957302570343,
            #                                 -0.034815702587366104,
            #                                 -0.058325015008449554,
            #                                 0.04689411073923111,
            #                                 -0.052248455584049225,
            #                                 0.03352069482207298,
            #                                 -0.0014374239835888147,
            #                                 -0.0022833794355392456,
            #                                 0.023297632113099098,
            #                                 -0.006064108107239008,
            #                                 0.03720647841691971,
            #                                 -0.0040219854563474655,
            #                                 0.004681939724832773,
            #                                 0.07471180707216263,
            #                                 0.008274332620203495,
            #                                 0.008380173705518246,
            #                                 -0.0006346612353809178,
            #                                 0.002698963973671198,
            #                                 0.038675811141729355,
            #                                 -0.04036927968263626,
            #                                 -0.06335560977458954,
            #                                 0.03673330321907997,
            #                                 0.038227539509534836,
            #                                 0.019661657512187958,
            #                                 0.028216158971190453,
            #                                 0.006310034543275833,
            #                                 0.046719782054424286,
            #                                 -0.008865800686180592,
            #                                 -0.007471180520951748,
            #                                 -0.026423074305057526,
            #                                 -0.0018973685801029205,
            #                                 -0.027220001444220543,
            #                                 0.0044422391802072525,
            #                                 0.0005712340353056788,
            #                                 -0.009289167821407318,
            #                                 0.05140172317624092,
            #                                 0.016835059970617294,
            #                                 0.022986331954598427,
            #                                 -0.019063962623476982,
            #                                 -0.014319762587547302,
            #                                 -0.02404474839568138,
            #                                 0.029934529215097427,
            #                                 -0.026323460042476654,
            #                                 0.04490179568529129,
            #                                 -0.02028425596654415,
            #                                 0.029311930760741234,
            #                                 0.04470256343483925,
            #                                 0.023783257231116295,
            #                                 0.02936173975467682,
            #                                 -0.004071793518960476,
            #                                 0.04310871288180351,
            #                                 0.03606089949607849,
            #                                 -0.0443539097905159,
            #                                 -0.004625905770808458,
            #                                 -0.001125346519984305,
            #                                 -0.03870071470737457,
            #                                 0.004034437704831362,
            #                                 -0.01588871143758297,
            #                                 0.03543829917907715,
            #                                 -0.011611459776759148,
            #                                 0.016361884772777557,
            #                                 0.02194036729633808,
            #                                 -0.016386788338422775,
            #                                 0.02317311242222786,
            #                                 -0.011505617760121822,
            #                                 0.03357050567865372,
            #                                 -0.014855197630822659,
            #                                 0.019923148676753044,
            #                                 -0.027643367648124695,
            #                                 -0.009407461620867252,
            #                                 -0.030034145340323448,
            #                                 -0.017843669280409813,
            #                                 -0.014880101196467876,
            #                                 0.010951505042612553,
            #                                 0.02570086158812046,
            #                                 0.005463300738483667,
            #                                 0.03611070662736893,
            #                                 -0.019063962623476982,
            #                                 0.020458582788705826,
            #                                 -0.032823387533426285,
            #                                 0.04046889394521713,
            #                                 -0.012059730477631092,
            #                                 -0.08093778789043427,
            #                                 -0.009668952785432339,
            #                                 -0.061861373484134674,
            #                                 0.019499780610203743,
            #                                 0.0005552798975259066,
            #                                 0.0062104188837111,
            #                                 0.015726834535598755,
            #                                 -0.046943917870521545,
            #                                 0.03324675187468529,
            #                                 -0.038899946957826614,
            #                                 -0.00570611422881484,
            #                                 -0.040668126195669174,
            #                                 -0.03753022849559784,
            #                                 -0.009121065959334373,
            #                                 0.026323460042476654,
            #                                 -0.01898925006389618,
            #                                 -0.00821829866617918,
            #                                 0.009071257896721363,
            #                                 0.03362031280994415,
            #                                 -0.054738849401474,
            #                                 -0.010633979924023151,
            #                                 0.05991886928677559,
            #                                 0.03882523626089096,
            #                                 -0.003330901265144348,
            #                                 0.027319617569446564,
            #                                 -0.01623736508190632,
            #                                 0.02604951523244381,
            #                                 -0.02604951523244381,
            #                                 -0.04271024838089943,
            #                                 -0.0012475315015763044,
            #                                 0.02352176606655121,
            #                                 0.08601818978786469,
            #                                 -0.05219864845275879,
            #                                 0.0004054672026541084,
            #                                 -0.013585096225142479,
            #                                 -0.1010601669549942,
            #                                 0.028191253542900085,
            #                                 -0.02714528888463974,
            #                                 -0.03264905884861946,
            #                                 0.05155114457011223,
            #                                 0.013647356070578098,
            #                                 0.007850965484976768,
            #                                 -0.05762770399451256,
            #                                 -0.0037449293304234743,
            #                                 -0.04193822667002678,
            #                                 -0.027518847957253456,
            #                                 0.06191118061542511,
            #                                 -0.006185514852404594,
            #                                 0.029959434643387794,
            #                                 -0.0748114213347435,
            #                                 -0.006306921597570181,
            #                                 -0.0357869528234005,
            #                                 -0.005245391279459,
            #                                 -0.002962011843919754,
            #                                 0.0074213724583387375,
            #                                 -0.03588657081127167,
            #                                 0.012115764431655407,
            #                                 0.01723352260887623,
            #                                 0.029635682702064514,
            #                                 0.02307349629700184,
            #                                 0.019163578748703003,
            #                                 0.00433017173781991,
            #                                 -0.007987936958670616,
            #                                 0.00783851370215416,
            #                                 0.018179873004555702,
            #                                 -0.005811955779790878,
            #                                 -0.028216158971190453,
            #                                 -0.03780417516827583,
            #                                 -0.0012436402030289173,
            #                                 0.0009860402205958962,
            #                                 -0.019910696893930435,
            #                                 0.049484118819236755,
            #                                 0.048263825476169586,
            #                                 0.02284936048090458,
            #                                 -0.019462425261735916,
            #                                 -0.03792869299650192,
            #                                 -0.01285043079406023,
            #                                 0.04026966169476509,
            #                                 0.04447842761874199,
            #                                 0.04106659069657326,
            #                                 -0.024779414758086205,
            #                                 0.0035425848327577114,
            #                                 -0.027718080207705498,
            #                                 0.018142515793442726,
            #                                 0.05349365249276161,
            #                                 -0.0004362079780548811,
            #                                 -0.0085607273504138,
            #                                 0.036683496087789536,
            #                                 -0.0045574200339615345,
            #                                 0.010409845039248466,
            #                                 -0.03862600401043892,
            #                                 0.005603385157883167,
            #                                 -0.01622491329908371,
            #                                 -0.009899314492940903,
            #                                 0.04973315820097923,
            #                                 -0.011574103496968746,
            #                                 -0.039896104484796524,
            #                                 0.013971107080578804,
            #                                 0.02405720204114914,
            #                                 -0.007359112612903118,
            #                                 -0.008778637275099754,
            #                                 0.001591517124325037,
            #                                 -0.01610039360821247,
            #                                 -0.004523177165538073,
            #                                 -0.0023736562579870224,
            #                                 -0.054888274520635605,
            #                                 -0.02339724637567997,
            #                                 0.024953743442893028,
            #                                 0.02946135587990284,
            #                                 -0.020595554262399673,
            #                                 -0.016610924154520035,
            #                                 -0.031030302867293358,
            #                                 0.0231606587767601,
            #                                 -0.017519919201731682,
            #                                 -0.042660441249608994,
            #                                 -0.016025682911276817,
            #                                 0.00011099761468358338,
            #                                 -0.008853348903357983,
            #                                 0.02726980857551098,
            #                                 0.013497932814061642,
            #                                 0.009724986739456654,
            #                                 0.022363733500242233,
            #                                 0.011717301793396473,
            #                                 -0.00932652410119772,
            #                                 -0.002719198353588581,
            #                                 -0.012937594205141068,
            #                                 -0.030831072479486465,
            #                                 -0.008909382857382298,
            #                                 0.01351038459688425,
            #                                 -0.0001350260281469673,
            #                                 0.002035896759480238,
            #                                 -0.034367430955171585,
            #                                 -0.004311493597924709,
            #                                 0.034790799021720886,
            #                                 0.040643222630023956,
            #                                 0.015751738101243973,
            #                                 -0.003517680801451206,
            #                                 -0.02109363302588463,
            #                                 -0.019263193011283875,
            #                                 0.02836558222770691,
            #                                 0.020234446972608566,
            #                                 -0.006123255006968975,
            #                                 0.04696882143616676,
            #                                 -0.03484060615301132,
            #                                 0.03254944458603859,
            #                                 -0.016486404463648796,
            #                                 0.006549735087901354,
            #                                 -0.0054041538387537,
            #                                 0.015054428949952126,
            #                                 -0.0005731796263717115,
            #                                 0.004006420727819204,
            #                                 0.026871345937252045,
            #                                 0.04400525242090225,
            #                                 0.02227656915783882,
            #                                 -0.021006468683481216,
            #                                 0.02238863706588745,
            #                                 -0.007963033393025398,
            #                                 -0.0013899508630856872,
            #                                 -0.017457658424973488,
            #                                 0.00987440999597311,
            #                                 0.013771875761449337,
            #                                 -0.007614378351718187,
            #                                 -0.004345736466348171,
            #                                 0.024654895067214966,
            #                                 -0.0002710248518269509,
            #                                 0.013746972195804119,
            #                                 0.006060995161533356,
            #                                 0.01025419495999813,
            #                                 0.036484263837337494,
            #                                 -0.020682718604803085,
            #                                 -0.007041587494313717,
            #                                 0.04866228997707367,
            #                                 -0.01788102462887764,
            #                                 0.025626149028539658,
            #                                 0.054738849401474,
            #                                 -0.03528887405991554,
            #                                 -0.04236159473657608,
            #                                 -0.007377790752798319,
            #                                 0.003607957623898983,
            #                                 0.03446704521775246,
            #                                 -0.008921834640204906,
            #                                 -0.00944481696933508,
            #                                 -0.051252298057079315,
            #                                 0.009600467048585415,
            #                                 -0.024343596771359444,
            #                                 0.035363588482141495,
            #                                 0.01588871143758297,
            #                                 -0.030482416972517967,
            #                                 -0.003832092974334955,
            #                                 -0.008019067347049713,
            #                                 0.05072931572794914,
            #                                 0.004622792825102806,
            #                                 -0.009388783946633339,
            #                                 -0.042635537683963776,
            #                                 0.0216166153550148,
            #                                 0.06255868822336197,
            #                                 -0.018615690991282463,
            #                                 0.0001475752651458606,
            #                                 -0.040145143866539,
            #                                 0.09652765095233917,
            #                                 0.06684216111898422,
            #                                 0.069332554936409,
            #                                 0.0005334889865480363,
            #                                 -0.07316776365041733,
            #                                 -0.00024359161034226418,
            #                                 0.013585096225142479,
            #                                 -0.024742059409618378,
            #                                 0.005388589110225439,
            #                                 0.013535289093852043,
            #                                 -0.006531056948006153,
            #                                 0.03000924177467823,
            #                                 -0.05468904227018356,
            #                                 0.012371029704809189,
            #                                 -0.022762196138501167,
            #                                 -0.013821683824062347,
            #                                 0.011567877605557442,
            #                                 -0.04736728593707085,
            #                                 0.04101677983999252,
            #                                 -0.006387859117239714,
            #                                 -0.005292086396366358,
            #                                 -0.0009385670418851078,
            #                                 -0.017744053155183792,
            #                                 -0.07037851959466934,
            #                                 0.005808842834085226,
            #                                 0.02726980857551098,
            #                                 -0.007016683463007212,
            #                                 -0.02116834558546543,
            #                                 0.002660051453858614,
            #                                 0.03650916740298271,
            #                                 -0.0146684180945158,
            #                                 -0.0005992509541101754,
            #                                 -0.0063940854743123055,
            #                                 0.008143587037920952,
            #                                 0.0405685119330883,
            #                                 -0.02339724637567997,
            #                                 0.029262123629450798,
            #                                 -0.043083809316158295,
            #                                 -0.0142824063077569,
            #                                 0.025314850732684135,
            #                                 0.007788705639541149,
            #                                 0.08352779597043991,
            #                                 0.03409348800778389,
            #                                 -0.008043970912694931,
            #                                 -0.01576419174671173,
            #                                 0.01766934245824814,
            #                                 -0.0019736369140446186,
            #                                 0.023347439244389534,
            #                                 0.026398170739412308,
            #                                 -0.005120871588587761,
            #                                 -0.013273796997964382,
            #                                 0.043407559394836426,
            #                                 -0.042087651789188385,
            #                                 -0.018802471458911896,
            #                                 -0.05812578275799751,
            #                                 0.015104237012565136,
            #                                 0.005382362753152847,
            #                                 0.009700082242488861,
            #                                 0.03974667936563492,
            #                                 -0.008149812929332256,
            #                                 -0.09050089865922928,
            #                                 0.061861373484134674,
            #                                 0.004289702977985144,
            #                                 -0.008934286423027515,
            #                                 0.03342108055949211,
            #                                 -0.01280062273144722,
            #                                 -0.004865606315433979,
            #                                 -0.029859818518161774,
            #                                 -0.03942292928695679,
            #                                 -0.051899801939725876,
            #                                 0.0010467434767633677,
            #                                 -0.04313361644744873,
            #                                 -0.011132058687508106,
            #                                 -0.008791089057922363,
            #                                 -0.039771582931280136,
            #                                 0.0648498460650444,
            #                                 0.03865090757608414,
            #                                 -0.04953392595052719,
            #                                 0.019562041386961937,
            #                                 -0.01590116322040558,
            #                                 -0.0006404980667866766,
            #                                 0.023920228704810143,
            #                                 0.004383092746138573,
            #                                 0.031727612018585205,
            #                                 -0.025065811350941658,
            #                                 -0.04368150234222412,
            #                                 -0.003853884059935808,
            #                                 0.0014101853594183922,
            #                                 -0.011275256983935833,
            #                                 -0.01588871143758297,
            #                                 -0.048936232924461365,
            #                                 -0.005603385157883167,
            #                                 -0.013124373741447926,
            #                                 0.05917175114154816,
            #                                 -0.013223989866673946,
            #                                 -0.014494090341031551,
            #                                 -0.007944355718791485,
            #                                 -0.020545747131109238,
            #                                 0.037903789430856705,
            #                                 0.0027674497105181217,
            #                                 -0.029411546885967255,
            #                                 0.01120054442435503,
            #                                 0.04776574671268463,
            #                                 -0.00036441461998037994,
            #                                 0.01755727455019951,
            #                                 0.036907631903886795,
            #                                 0.0054072667844593525,
            #                                 -0.022650128230452538,
            #                                 -0.03145366907119751,
            #                                 -0.03807811811566353,
            #                                 0.058872900903224945,
            #                                 0.01141222845762968,
            #                                 -0.007819836027920246,
            #                                 -0.0019004815258085728,
            #                                 0.011069798842072487,
            #                                 -0.015465343371033669,
            #                                 -0.011349968612194061,
            #                                 0.03302261605858803,
            #                                 0.03185213357210159,
            #                                 -0.04490179568529129,
            #                                 -0.00854827556759119,
            #                                 0.0041278270073235035,
            #                                 -0.009911766275763512,
            #                                 -0.019910696893930435,
            #                                 0.012476871721446514,
            #                                 0.016685636714100838,
            #                                 -0.0219652708619833,
            #                                 -0.010272873565554619,
            #                                 0.02968548983335495,
            #                                 -0.013659808784723282,
            #                                 0.03100539930164814,
            #                                 -0.02438095211982727,
            #                                 0.04226197674870491,
            #                                 -0.0045449682511389256,
            #                                 0.014045819640159607,
            #                                 -0.019026607275009155,
            #                                 -0.01113828457891941,
            #                                 0.007614378351718187,
            #                                 -0.025576341897249222,
            #                                 -0.028739141300320625,
            #                                 0.0021432950161397457,
            #                                 -0.027842599898576736,
            #                                 0.005718566011637449,
            #                                 0.021218152716755867,
            #                                 -0.0190888661891222,
            #                                 -0.02570086158812046,
            #                                 0.01137487217783928,
            #                                 -0.007963033393025398,
            #                                 -0.053443845361471176,
            #                                 -0.016847511753439903,
            #                                 0.007178559433668852,
            #                                 -0.018030449748039246,
            #                                 -0.0014086287701502442,
            #                                 0.0056376284919679165,
            #                                 -0.018030449748039246,
            #                                 -0.06275791674852371,
            #                                 -0.008025293238461018,
            #                                 -0.014095626771450043,
            #                                 0.007078943308442831,
            #                                 0.07660450041294098,
            #                                 0.0077451239340007305,
            #                                 0.043980348855257034,
            #                                 0.04059341549873352,
            #                                 -0.005460187792778015,
            #                                 -0.022924073040485382,
            #                                 -0.012999854050576687,
            #                                 -0.04465275630354881,
            #                                 -0.0048002335242927074,
            #                                 -0.003931708633899689,
            #                                 -0.00810623075813055,
            #                                 0.019562041386961937,
            #                                 -0.029287027195096016,
            #                                 -0.010011381469666958,
            #                                 0.020570650696754456,
            #                                 0.01720861904323101,
            #                                 -0.007240819279104471,
            #                                 0.00384765793569386,
            #                                 0.006499927025288343,
            #                                 0.013385864906013012,
            #                                 0.02327272668480873,
            #                                 0.007570796180516481,
            #                                 -0.01800554431974888,
            #                                 0.031827230006456375,
            #                                 0.011051121167838573,
            #                                 -0.019337905570864677,
            #                                 -0.01180446520447731,
            #                                 -0.013423221185803413,
            #                                 0.02150454744696617,
            #                                 -0.02328517846763134,
            #                                 -0.0022055546287447214,
            #                                 -0.01678525283932686,
            #                                 0.01357264444231987,
            #                                 -0.01634943298995495,
            #                                 -0.05394192412495613,
            #                                 0.017843669280409813,
            #                                 0.036035992205142975,
            #                                 -0.012974950484931469,
            #                                 0.05722924321889877,
            #                                 0.003439855994656682,
            #                                 -0.01698448322713375,
            #                                 0.031627997756004333,
            #                                 -0.007938128896057606,
            #                                 -0.01821722835302353,
            #                                 -0.023783257231116295,
            #                                 0.0035986185539513826,
            #                                 0.015963422134518623,
            #                                 -0.01819232478737831,
            #                                 0.01887718215584755,
            #                                 -0.006282017566263676,
            #                                 0.0030009241309016943,
            #                                 0.011287708766758442,
            #                                 -0.0181051604449749,
            #                                 0.013983559794723988,
            #                                 0.025875188410282135,
            #                                 -0.010764725506305695,
            #                                 -0.003751155221834779,
            #                                 0.025526532903313637,
            #                                 -0.029959434643387794,
            #                                 0.014954812824726105,
            #                                 0.003913030959665775,
            #                                 0.02724490500986576,
            #                                 -0.019948052242398262,
            #                                 -0.03013376146554947,
            #                                 0.004015759564936161,
            #                                 -0.029934529215097427,
            #                                 0.010615302249789238,
            #                                 0.0031114353332668543,
            #                                 0.007925677113234997,
            #                                 0.012887786142528057,
            #                                 0.03210117295384407,
            #                                 0.017345590516924858,
            #                                 0.059520404785871506,
            #                                 -0.04858757555484772,
            #                                 0.031827230006456375,
            #                                 -0.005316989962011576,
            #                                 -0.012483097612857819,
            #                                 0.004641470964998007,
            #                                 0.014718225225806236,
            #                                 -0.022600321099162102,
            #                                 0.0041153752245008945,
            #                                 -0.03000924177467823,
            #                                 0.019723916426301003,
            #                                 -0.010011381469666958,
            #                                 0.02151699922978878,
            #                                 0.015029524452984333,
            #                                 0.004271024838089943,
            #                                 0.033695023506879807,
            #                                 0.0073342090472579,
            #                                 -0.008299236185848713,
            #                                 -0.044403716921806335,
            #                                 0.003474098863080144,
            #                                 0.04490179568529129,
            #                                 -0.011735979467630386,
            #                                 0.0008537380490452051,
            #                                 -0.01677280105650425,
            #                                 0.015303468331694603,
            #                                 0.015017072670161724,
            #                                 0.04612208902835846,
            #                                 0.010951505042612553,
            #                                 0.0035986185539513826,
            #                                 -0.02352176606655121,
            #                                 0.006773870438337326,
            #                                 -0.010621528141200542,
            #                                 0.012034826911985874,
            #                                 0.012371029704809189,
            #                                 -0.04664507135748863,
            #                                 0.012744588777422905,
            #                                 -0.048936232924461365,
            #                                 0.01830439269542694,
            #                                 -0.011567877605557442,
            #                                 0.022886715829372406,
            #                                 -0.03914898633956909,
            #                                 0.030059048905968666,
            #                                 -0.02150454744696617,
            #                                 -0.014905004762113094,
            #                                 0.0038694487884640694,
            #                                 -0.05199941620230675,
            #                                 -0.007103847339749336,
            #                                 -0.0012529792729765177,
            #                                 0.013709615916013718,
            #                                 -0.04051870107650757,
            #                                 0.023036139085888863,
            #                                 -0.004386205691844225,
            #                                 -0.004214990884065628,
            #                                 -0.0328482910990715,
            #                                 -0.004625905770808458,
            #                                 0.0003739481617230922,
            #                                 -0.017706697806715965,
            #                                 -0.02781769633293152,
            #                                 -0.0013144607655704021,
            #                                 -0.02901308424770832,
            #                                 0.00014592149818781763,
            #                                 0.025800475850701332,
            #                                 0.051252298057079315,
            #                                 -0.027618464082479477,
            #                                 -0.020608006045222282,
            #                                 0.0085980836302042,
            #                                 0.025090714916586876,
            #                                 -0.01136242039501667,
            #                                 -0.005030594766139984,
            #                                 0.01664828136563301,
            #                                 0.020919306203722954,
            #                                 -0.02328517846763134,
            #                                 -0.04522554576396942,
            #                                 -0.014755581505596638,
            #                                 -0.006297582760453224,
            #                                 -0.05050517991185188,
            #                                 0.005363685078918934,
            #                                 0.026647210121154785,
            #                                 0.0071162995882332325,
            #                                 -0.051252298057079315,
            #                                 -0.016586020588874817,
            #                                 0.03583676367998123,
            #                                 -0.011418454349040985,
            #                                 -0.025215234607458115,
            #                                 -0.05204922333359718,
            #                                 -0.001942506874911487,
            #                                 -0.019823532551527023,
            #                                 -0.00259156571701169,
            #                                 -0.036683496087789536,
            #                                 -0.035139452666044235,
            #                                 -0.0020405661780387163,
            #                                 -0.04818911477923393,
            #                                 0.008803540840744972,
            #                                 0.0021168345119804144,
            #                                 -0.01384658832103014,
            #                                 0.0076081519946455956,
            #                                 -0.04114130139350891,
            #                                 0.015291016548871994,
            #                                 -0.005310764070600271,
            #                                 0.024468116462230682,
            #                                 0.008542049676179886,
            #                                 -0.02109363302588463,
            #                                 0.017706697806715965,
            #                                 -0.020471034571528435,
            #                                 -0.0017105890437960625,
            #                                 0.04450333118438721,
            #                                 0.016461500898003578,
            #                                 -0.02570086158812046,
            #                                 0.01379678025841713,
            #                                 0.023471958935260773,
            #                                 0.037231381982564926,
            #                                 0.04315852001309395,
            #                                 0.03531378135085106,
            #                                 0.0038009630516171455,
            #                                 0.03720647841691971,
            #                                 -0.018117612227797508,
            #                                 -0.015801547095179558,
            #                                 -0.013659808784723282,
            #                                 0.019811080768704414,
            #                                 -0.03210117295384407,
            #                                 0.019948052242398262,
            #                                 0.03329656273126602,
            #                                 0.00640031136572361,
            #                                 0.018802471458911896,
            #                                 0.038675811141729355,
            #                                 -0.028415389358997345,
            #                                 -0.03170270845293999,
            #                                 0.04026966169476509,
            #                                 0.046744685620069504,
            #                                 -0.01126280426979065,
            #                                 0.015926066786050797,
            #                                 0.016698088496923447,
            #                                 0.01840400882065296,
            #                                 -0.02217695489525795,
            #                                 0.011935210786759853,
            #                                 0.012333673425018787,
            #                                 -0.025190331041812897,
            #                                 -0.027767887338995934,
            #                                 -0.011387323960661888,
            #                                 -0.005011917091906071,
            #                                 0.00981215015053749,
            #                                 0.01191653311252594,
            #                                 0.028415389358997345,
            #                                 0.002547983778640628,
            #                                 0.040892262011766434,
            #                                 0.04731747508049011,
            #                                 0.06131348758935928,
            #                                 -0.00993666984140873,
            #                                 0.032947905361652374,
            #                                 -0.04490179568529129,
            #                                 0.016162654384970665,
            #                                 0.017930833622813225,
            #                                 0.009849506430327892,
            #                                 0.019935600459575653,
            #                                 -0.001293448149226606,
            #                                 0.02515297383069992,
            #                                 0.045972663909196854,
            #                                 0.022139597684144974,
            #                                 -0.009121065959334373,
            #                                 0.007371564861387014,
            #                                 -0.002258475637063384,
            #                                 0.03606089949607849,
            #                                 -0.0022631450556218624,
            #                                 -0.01534082368016243,
            #                                 0.0020950434263795614,
            #                                 0.03777926787734032,
            #                                 -0.012053504586219788,
            #                                 -0.01973636820912361,
            #                                 0.04019495099782944,
            #                                 -0.018379103392362595,
            #                                 -0.021317768841981888,
            #                                 0.0025277493987232447,
            #                                 0.014967264607548714,
            #                                 0.03541339561343193,
            #                                 -0.014319762587547302,
            #                                 -0.016623375937342644,
            #                                 0.001554161193780601,
            #                                 -0.03785398229956627,
            #                                 -0.01357264444231987,
            #                                 -0.05085383355617523,
            #                                 -0.03750532492995262,
            #                                 -0.0036297484766691923,
            #                                 0.05110287293791771,
            #                                 0.024891482666134834,
            #                                 -0.009843280538916588,
            #                                 0.010509460233151913,
            #                                 -0.01864059455692768,
            #                                 0.0051053068600595,
            #                                 0.02415681630373001,
            #                                 0.005341893993318081,
            #                                 0.01567702740430832,
            #                                 -0.013410769402980804,
            #                                 -0.002887299982830882,
            #                                 -0.02152945101261139,
            #                                 0.012389707379043102,
            #                                 0.018366651609539986,
            #                                 0.04666997492313385,
            #                                 -0.05155114457011223,
            #                                 0.009830828756093979,
            #                                 -0.012078408151865005,
            #                                 -0.010889245197176933,
            #                                 -0.025402013212442398,
            #                                 0.005718566011637449,
            #                                 0.015701930969953537,
            #                                 -0.02283690869808197,
            #                                 0.003145678201690316,
            #                                 -0.026223843917250633,
            #                                 -0.043756213039159775,
            #                                 -0.031179726123809814,
            #                                 -0.011468262411653996,
            #                                 0.011275256983935833,
            #                                 0.030930686742067337,
            #                                 0.022102242335677147,
            #                                 0.006562186870723963,
            #                                 0.004784668330103159,
            #                                 -0.018740210682153702,
            #                                 0.03952254354953766,
            #                                 0.004473369102925062,
            #                                 0.026223843917250633,
            #                                 -0.010633979924023151,
            #                                 -0.025090714916586876,
            #                                 -0.0016421031905338168,
            #                                 0.013385864906013012,
            #                                 0.007713994011282921,
            #                                 0.017706697806715965,
            #                                 0.008803540840744972,
            #                                 -0.0017697358271107078,
            #                                 0.04950902238488197,
            #                                 0.002311396412551403,
            #                                 -0.02216450124979019,
            #                                 0.008535823784768581,
            #                                 0.008884478360414505,
            #                                 0.005217374302446842,
            #                                 -0.01689732074737549,
            #                                 -0.0011549199698492885,
            #                                 -0.014232599176466465,
            #                                 0.024107009172439575,
            #                                 -0.016959579661488533,
            #                                 0.0308061670511961,
            #                                 0.012402160093188286,
            #                                 -0.007520988583564758,
            #                                 0.029411546885967255,
            #                                 0.026796633377671242,
            #                                 0.006531056948006153,
            #                                 0.017955737188458443,
            #                                 -0.02704567275941372,
            #                                 -0.021205700933933258,
            #                                 -0.039896104484796524,
            #                                 -0.0036733304150402546,
            #                                 0.028664428740739822,
            #                                 0.04094206914305687,
            #                                 0.01202237419784069,
            #                                 0.027668271213769913,
            #                                 0.019462425261735916,
            #                                 0.017283331602811813,
            #                                 0.013261345215141773,
            #                                 0.05299557372927666,
            #                                 0.017607081681489944,
            #                                 0.004902962129563093,
            #                                 0.032723769545555115,
            #                                 -0.016586020588874817,
            #                                 0.003455420956015587,
            #                                 0.025651052594184875,
            #                                 0.03454175963997841,
            #                                 -0.040219854563474655,
            #                                 -0.007869643159210682,
            #                                 0.014008463360369205,
            #                                 0.013024757616221905,
            #                                 0.0058368598110973835,
            #                                 0.028614621609449387,
            #                                 0.022575417533516884,
            #                                 -0.01275081466883421,
            #                                 -0.0052298265509307384,
            #                                 -0.029536066576838493,
            #                                 -0.0357869528234005,
            #                                 -0.023696094751358032,
            #                                 0.0098246019333601,
            #                                 0.0009860402205958962,
            #                                 0.009027676656842232,
            #                                 -0.01996050402522087,
            #                                 0.018453815951943398,
            #                                 0.020259350538253784,
            #                                 0.029062891378998756,
            #                                 0.02296142838895321,
            #                                 -0.020670266821980476,
            #                                 0.010951505042612553,
            #                                 0.001942506874911487,
            #                                 0.0032655284740030766,
            #                                 0.004569872282445431,
            #                                 0.03942292928695679,
            #                                 0.027992023155093193,
            #                                 -0.0028250401373952627,
            #                                 0.026198940351605415,
            #                                 -0.044304098933935165,
            #                                 -0.026223843917250633,
            #                                 0.0270207691937685,
            #                                 0.000630380876827985,
            #                                 0.01363490428775549,
            #                                 0.0381777323782444,
            #                                 -0.045399874448776245,
            #                                 -0.011897854506969452,
            #                                 0.006387859117239714,
            #                                 0.009974026121199131,
            #                                 0.012875334359705448,
            #                                 0.016361884772777557,
            #                                 -0.03484060615301132,
            #                                 0.007371564861387014,
            #                                 0.0031908166129142046,
            #                                 -0.018354199826717377,
            #                                 0.0017121455166488886,
            #                                 -0.008286784403026104,
            #                                 -0.009668952785432339,
            #                                 -0.007016683463007212,
            #                                 -0.014655965380370617,
            #                                 -0.03496512398123741,
            #                                 -0.06136329472064972,
            #                                 -0.040892262011766434,
            #                                 -0.014431830495595932,
            #                                 -0.004588549956679344,
            #                                 0.0108083076775074,
            #                                 0.00643144128844142,
            #                                 0.02824106253683567,
            #                                 -0.010247969068586826,
            #                                 -0.0044422391802072525,
            #                                 0.018565883859992027,
            #                                 0.007321756798774004,
            #                                 -0.005379249807447195,
            #                                 0.036260128021240234,
            #                                 0.016486404463648796,
            #                                 0.008984094485640526,
            #                                 -0.01730823516845703,
            #                                 0.004389318637549877,
            #                                 -0.004174522124230862,
            #                                 0.017594629898667336,
            #                                 -0.024082105606794357,
            #                                 0.031030302867293358,
            #                                 -0.01831684447824955,
            #                                 -0.022475801408290863,
            #                                 -0.0029324383940547705,
            #                                 0.02415681630373001,
            #                                 -0.00532632926478982,
            #                                 0.03837696462869644,
            #                                 0.0008957633981481194,
            #                                 0.03770455718040466,
            #                                 0.047068435698747635,
            #                                 0.0162124615162611,
            #                                 -0.03511454910039902,
            #                                 0.006387859117239714,
            #                                 -0.019599396735429764,
            #                                 -0.008971642702817917,
            #                                 -0.002277153544127941,
            #                                 0.025028454139828682,
            #                                 0.009363879449665546,
            #                                 -0.012514227069914341,
            #                                 0.020720073953270912,
            #                                 0.008909382857382298,
            #                                 0.005369910970330238,
            #                                 -0.028888564556837082,
            #                                 -0.029311930760741234,
            #                                 -0.028838757425546646,
            #                                 -0.027942214161157608,
            #                                 -0.015589863061904907,
            #                                 0.03750532492995262,
            #                                 -0.015315920114517212,
            #                                 -2.784668504318688e-05,
            #                                 -0.009619144722819328,
            #                                 -0.012433289550244808,
            #                                 0.011760883033275604,
            #                                 -0.00452006421983242,
            #                                 0.022152049466967583,
            #                                 0.03516435623168945,
            #                                 0.013585096225142479,
            #                                 0.004404883366078138,
            #                                 -0.01590116322040558,
            #                                 -0.011623911559581757,
            #                                 -0.0027830146718770266,
            #                                 0.020271802321076393,
            #                                 -0.03170270845293999,
            #                                 -0.020022762939333916,
            #                                 0.015054428949952126,
            #                                 0.01141222845762968,
            #                                 0.00027083029272034764,
            #                                 0.012445741333067417,
            #                                 -0.008454886265099049,
            #                                 -0.02426888421177864,
            #                                 0.008915608748793602,
            #                                 0.022450897842645645,
            #                                 -0.0200725719332695,
            #                                 0.03708196058869362,
            #                                 0.006948197726160288,
            #                                 -0.0076081519946455956,
            #                                 -0.02448056824505329,
            #                                 0.0020109927281737328,
            #                                 -0.017619533464312553,
            #                                 -0.0018288827268406749,
            #                                 -0.016287174075841904,
            #                                 -0.0024903935845941305,
            #                                 0.01544043980538845,
            #                                 -0.0010630866745486856,
            #                                 -0.017407851293683052,
            #                                 -0.019711464643478394,
            #                                 0.006481248885393143,
            #                                 -0.015627218410372734,
            #                                 0.02682153880596161,
            #                                 -0.019611848518252373,
            #                                 -0.026198940351605415,
            #                                 0.021429836750030518,
            #                                 0.0196492038667202,
            #                                 0.013074565678834915,
            #                                 -0.018279489129781723,
            #                                 -0.013062113896012306,
            #                                 -0.007458728738129139,
            #                                 0.0028546135872602463,
            #                                 -0.0035612627398222685,
            #                                 0.01456880196928978,
            #                                 0.011922759003937244,
            #                                 -0.012190476059913635,
            #                                 0.009799698367714882,
            #                                 -0.006805000361055136,
            #                                 0.004495160188525915,
            #                                 -0.002365873893722892,
            #                                 0.024916386231780052,
            #                                 0.0005969161866232753,
            #                                 -0.025414464995265007,
            #                                 0.016299625858664513,
            #                                 -0.02141738496720791,
            #                                 -0.01720861904323101,
            #                                 -0.002979133278131485,
            #                                 -0.01229631807655096,
            #                                 0.030407704412937164,
            #                                 -0.031727612018585205,
            #                                 0.027220001444220543,
            #                                 -0.013834135606884956,
            #                                 0.02901308424770832,
            #                                 0.0015012403018772602,
            #                                 0.01455635018646717,
            #                                 -0.023770805448293686,
            #                                 0.022226762026548386,
            #                                 0.011051121167838573,
            #                                 0.04833853617310524,
            #                                 -0.006263339426368475,
            #                                 0.0043581887148320675,
            #                                 -0.026672113686800003,
            #                                 -0.01461861003190279,
            #                                 -0.050156526267528534,
            #                                 0.030432607978582382,
            #                                 -0.02338479459285736,
            #                                 -0.02283690869808197,
            #                                 -0.058325015008449554,
            #                                 -0.010727370157837868,
            #                                 0.014481638558208942,
            #                                 -0.0033589182421565056,
            #                                 0.012190476059913635,
            #                                 -0.035139452666044235,
            #                                 -0.018142515793442726,
            #                                 -0.018466267734766006,
            #                                 -0.03431762382388115,
            #                                 -0.010945279151201248,
            #                                 0.018055353313684464,
            #                                 -0.034143295139074326,
            #                                 -0.010995087213814259,
            #                                 -0.030059048905968666,
            #                                 0.015141592361032963,
            #                                 0.00455119414255023,
            #                                 0.01998540759086609,
            #                                 -0.002681842539459467,
            #                                 0.005282747093588114,
            #                                 0.020994016900658607,
            #                                 -0.029212316498160362,
            #                                 -0.017370494082570076,
            #                                 0.020495938137173653,
            #                                 0.03035789728164673,
            #                                 -0.027220001444220543,
            #                                 0.03456666320562363,
            #                                 0.029536066576838493,
            #                                 -0.025314850732684135,
            #                                 -0.012962497770786285,
            #                                 0.020583102479577065,
            #                                 0.05040556564927101,
            #                                 -0.0055224476382136345,
            #                                 0.020670266821980476,
            #                                 0.020570650696754456,
            #                                 0.01601323112845421,
            #                                 0.034491948783397675,
            #                                 -0.041539762169122696,
            #                                 0.026647210121154785,
            #                                 0.01587625779211521,
            #                                 0.015477795153856277,
            #                                 0.08148567378520966,
            #                                 0.010005155578255653,
            #                                 -0.011698623187839985,
            #                                 -0.02570086158812046,
            #                                 -0.029834914952516556,
            #                                 -0.041564665734767914,
            #                                 -0.016187557950615883,
            #                                 -0.006229096557945013,
            #                                 0.017607081681489944,
            #                                 0.012825526297092438,
            #                                 0.01723352260887623,
            #                                 0.011493165977299213,
            #                                 0.00883467122912407,
            #                                 0.012252735905349255,
            #                                 -0.026672113686800003,
            #                                 -0.008672795258462429,
            #                                 -0.006120142061263323,
            #                                 -0.0216166153550148,
            #                                 -0.021118536591529846,
            #                                 -0.04328303784132004,
            #                                 -0.03212607651948929,
            #                                 -0.016137750819325447,
            #                                 0.005581594537943602,
            #                                 0.006468797102570534,
            #                                 0.014581253752112389,
            #                                 0.00044243395677767694,
            #                                 -0.03518925979733467,
            #                                 0.033172041177749634,
            #                                 -0.013759423978626728,
            #                                 -0.0007447833195328712,
            #                                 0.024517923593521118,
            #                                 -0.01169239729642868,
            #                                 0.011057347059249878,
            #                                 0.0028655091300606728,
            #                                 -0.0001284109166590497,
            #                                 0.04480217769742012,
            #                                 -0.017918381839990616,
            #                                 -0.008461112156510353,
            #                                 -0.02846519835293293,
            #                                 0.04759141802787781,
            #                                 -0.008504693396389484,
            #                                 -0.008759959600865841,
            #                                 0.003327788319438696,
            #                                 -0.014581253752112389,
            #                                 -0.004074906464666128,
            #                                 -0.010534364730119705,
            #                                 0.02095666155219078,
            #                                 0.022027529776096344,
            #                                 0.01776895672082901,
            #                                 -0.026198940351605415,
            #                                 -0.007614378351718187,
            #                                 0.018366651609539986,
            #                                 0.014631061814725399,
            #                                 0.024256432428956032,
            #                                 0.016249816864728928,
            #                                 0.03297280892729759,
            #                                 0.011518069542944431,
            #                                 -0.005525560583919287,
            #                                 -0.004420448560267687,
            #                                 0.01600077748298645,
            #                                 -0.019362809136509895,
            #                                 -0.0054041538387537,
            #                                 0.014780485071241856,
            #                                 -0.01352283637970686,
            #                                 0.015838902443647385,
            #                                 -0.010397393256425858,
            #                                 -0.007751349825412035,
            #                                 -0.016498856246471405,
            #                                 0.015104237012565136,
            #                                 0.01468086987733841,
            #                                 -0.005108419805765152,
            #                                 0.04201293736696243,
            #                                 -0.04328303784132004,
            #                                 0.015315920114517212,
            #                                 0.022924073040485382,
            #                                 -0.019176030531525612,
            #                                 -0.0001800671307137236,
            #                                 -0.031378958374261856,
            #                                 -0.053244613111019135,
            #                                 0.06036713719367981,
            #                                 -0.021317768841981888,
            #                                 0.025551436468958855,
            #                                 0.01865304820239544,
            #                                 -0.00777625385671854,
            #                                 0.045300256460905075,
            #                                 0.009588015265762806,
            #                                 -0.00849846750497818,
            #                                 -0.004713069647550583,
            #                                 0.026348363608121872,
            #                                 -0.021878106519579887,
            #                                 0.039124082773923874,
            #                                 0.014257502742111683,
            #                                 -0.005288972984999418,
            #                                 0.002233571605756879,
            #                                 0.006917067803442478,
            #                                 0.008019067347049713,
            #                                 0.0014856753405183554,
            #                                 0.0005257065058685839,
            #                                 -0.03192684426903725,
            #                                 -0.0308808796107769,
            #                                 -0.0014195243129506707,
            #                                 -0.029087796807289124,
            #                                 0.010876793414354324,
            #                                 -0.02560124546289444,
            #                                 0.00788832176476717,
            #                                 -0.03489041328430176,
            #                                 -0.0031690257601439953,
            #                                 -0.007271949201822281,
            #                                 -0.019474877044558525,
            #                                 0.006917067803442478,
            #                                 0.023222919553518295,
            #                                 -0.006736514624208212,
            #                                 0.00010233961074845865,
            #                                 0.028315773233771324,
            #                                 0.018179873004555702,
            #                                 0.001277104951441288,
            #                                 -0.009475947357714176,
            #                                 0.01708409935235977,
            #                                 0.013971107080578804,
            #                                 0.029859818518161774,
            #                                 0.005444622598588467,
            #                                 0.012302543967962265,
            #                                 0.008361496031284332,
            #                                 0.014954812824726105,
            #                                 -0.009195777587592602,
            #                                 0.015913615003228188,
            #                                 0.0012887786142528057,
            #                                 0.03352069482207298,
            #                                 -0.03299771249294281,
            #                                 0.01153674814850092,
            #                                 0.030980495736002922,
            #                                 0.01887718215584755,
            #                                 -0.0037791721988469362,
            #                                 -0.008305462077260017,
            #                                 -0.0036048446781933308,
            #                                 0.038775425404310226,
            #                                 -0.009625370614230633,
            #                                 0.027294712141156197,
            #                                 0.0015650566201657057,
            #                                 0.025900091975927353,
            #                                 -0.004398657474666834,
            #                                 -0.030955590307712555,
            #                                 -0.02858971804380417,
            #                                 -0.017955737188458443,
            #                                 0.014332214370369911,
            #                                 0.026746826246380806,
            #                                 -0.0067925481125712395,
            #                                 0.008654117584228516,
            #                                 0.014257502742111683,
            #                                 -0.004401770420372486,
            #                                 -0.011256578378379345,
            #                                 -0.022139597684144974,
            #                                 -0.0006852473597973585,
            #                                 0.00469127856194973,
            #                                 -0.010335133410990238,
            #                                 -0.04614699259400368,
            #                                 0.029635682702064514,
            #                                 -0.023683642968535423,
            #                                 -0.007489858660846949,
            #                                 -0.0013424777425825596,
            #                                 -0.007166107185184956,
            #                                 -0.027892407029867172,
            #                                 -0.035562820732593536,
            #                                 0.014655965380370617,
            #                                 -0.014543898403644562,
            #                                 0.029735298827290535,
            #                                 -0.031627997756004333,
            #                                 0.005541125312447548,
            #                                 0.014581253752112389,
            #                                 -0.008230750449001789,
            #                                 -0.011399776674807072,
            #                                 0.01742030307650566,
            #                                 -0.017619533464312553,
            #                                 0.011038669385015965,
            #                                 0.011617685668170452,
            #                                 0.003533245762810111,
            #                                 0.00405934127047658,
            #                                 0.0033433532807976007,
            #                                 -0.011717301793396473,
            #                                 0.003380709094926715,
            #                                 0.0114744883030653,
            #                                 0.048263825476169586,
            #                                 -0.004563645925372839,
            #                                 -0.0028997519984841347,
            #                                 0.00606722105294466,
            #                                 -0.00022121697838883847,
            #                                 -0.012539131566882133,
            #                                 -0.019611848518252373,
            #                                 0.044304098933935165,
            #                                 0.006661802530288696,
            #                                 -0.010135901160538197,
            #                                 -0.03743061423301697,
            #                                 -0.01456880196928978,
            #                                 -0.006817452143877745,
            #                                 -0.03962216153740883,
            #                                 0.005148888565599918,
            #                                 -0.015813998878002167,
            #                                 -0.019039059057831764,
            #                                 0.011462036520242691,
            #                                 -0.0001497154589742422,
            #                                 0.021554356440901756,
            #                                 0.007794931530952454,
            #                                 -0.03708196058869362,
            #                                 -0.003828980028629303,
            #                                 0.04644583910703659,
            #                                 0.00714120315387845,
            #                                 -0.0022849361412227154,
            #                                 0.036558978259563446,
            #                                 0.007925677113234997,
            #                                 0.026522690430283546,
            #                                 0.021790944039821625,
            #                                 0.006070333998650312,
            #                                 0.005117758642882109,
            #                                 -0.006717836484313011,
            #                                 -0.022201858460903168,
            #                                 -0.0024857239332050085,
            #                                 0.0328482910990715,
            #                                 0.01577664352953434,
            #                                 0.01953713782131672,
            #                                 -0.020583102479577065,
            #                                 0.016050586476922035,
            #                                 -0.029511163011193275,
            #                                 -0.008423755876719952,
            #                                 0.0005797947524115443,
            #                                 -0.017258426174521446,
            #                                 -0.0009097718866541982,
            #                                 -0.0017245975323021412,
            #                                 -0.004946544300764799,
            #                                 -0.040668126195669174,
            #                                 -0.015515151433646679,
            #                                 0.03000924177467823,
            #                                 0.011225448921322823,
            #                                 0.02175358682870865,
            #                                 0.0010218395618721843,
            #                                 0.00904012843966484,
            #                                 -0.022550513967871666,
            #                                 -0.007477406412363052,
            #                                 -0.009046354331076145,
            #                                 -0.04881171137094498,
            #                                 0.006014300510287285,
            #                                 0.05947059765458107,
            #                                 -0.010995087213814259,
            #                                 -0.029635682702064514,
            #                                 0.0020281141623854637,
            #                                 0.022650128230452538,
            #                                 0.025402013212442398,
            #                                 0.009189551696181297,
            #                                 -0.016959579661488533,
            #                                 -0.005864876788109541,
            #                                 -0.0014358675107359886,
            #                                 -0.0021355124190449715,
            #                                 0.0006618999177590013,
            #                                 0.03962216153740883,
            #                                 0.017731601372361183,
            #                                 -0.04039418324828148,
            #                                 0.05513731390237808,
            #                                 -0.017781410366296768,
            #                                 -0.011449583806097507,
            #                                 -0.0012809961335733533,
            #                                 0.04061831906437874,
            #                                 0.0017292669508606195,
            #                                 0.0023596477694809437,
            #                                 -0.028415389358997345,
            #                                 0.00114558101631701,
            #                                 -0.018628142774105072,
            #                                 -1.292621254833648e-05,
            #                                 -0.00987440999597311,
            #                                 -0.0196492038667202,
            #                                 -0.037903789430856705,
            #                                 -0.002962011843919754,
            #                                 -0.004725521896034479,
            #                                 -0.027369424700737,
            #                                 0.01910131797194481,
            #                                 0.020458582788705826,
            #                                 -0.01534082368016243,
            #                                 0.00673028826713562,
            #                                 0.046719782054424286,
            #                                 -0.0034491950646042824,
            #                                 -0.02537710964679718,
            #                                 -0.005799503996968269,
            #                                 -0.002778345253318548,
            #                                 0.018017996102571487,
            #                                 -0.004924753215163946,
            #                                 -0.018777567893266678,
            #                                 -0.0010630866745486856,
            #                                 0.026099324226379395,
            #                                 0.017034292221069336,
            #                                 0.04676958918571472,
            #                                 0.003685782430693507,
            #                                 -0.002090374007821083,
            #                                 0.012395933270454407,
            #                                 -0.006232209969311953,
            #                                 -0.042635537683963776,
            #                                 -0.0074089206755161285,
            #                                 -0.02373345009982586,
            #                                 -0.011785787530243397,
            #                                 0.029486259445548058,
            #                                 -0.03376973420381546,
            #                                 -0.021977722644805908,
            #                                 0.013871491886675358,
            #                                 0.00044476872426457703,
            #                                 -0.006861034315079451,
            #                                 -0.013709615916013718,
            #                                 -0.0030087067279964685,
            #                                 -0.0063505033031105995,
            #                                 0.0017681793542578816,
            #                                 -0.0036328614223748446,
            #                                 0.03319694474339485,
            #                                 0.004106036387383938,
            #                                 0.013373413123190403,
            #                                 -0.03055712766945362,
            #                                 -0.004183860961347818,
            #                                 -0.052447687834501266,
            #                                 -0.041415244340896606,
            #                                 -0.0038258670829236507,
            #                                 0.028863660991191864,
            #                                 0.028988180682063103,
            #                                 -0.030482416972517967,
            #                                 0.011219223029911518,
            #                                 0.021566808223724365,
            #                                 0.03175251558423042,
            #                                 -0.01185427326709032,
            #                                 0.01610039360821247,
            #                                 0.020446131005883217,
            #                                 0.02028425596654415,
            #                                 0.012837978079915047,
            #                                 -0.0009377888054586947,
            #                                 -0.0010475217131897807,
            #                                 0.014593705534934998,
            #                                 -0.036583881825208664,
            #                                 -0.002795466687530279,
            #                                 -0.02020954340696335,
            #                                 0.0066742547787725925,
            #                                 0.007969259284436703,
            #                                 0.009843280538916588,
            #                                 -0.027618464082479477,
            #                                 -0.009114840067923069,
            #                                 -0.01611284539103508,
            #                                 -0.026323460042476654,
            #                                 -0.0012109538074582815,
            #                                 -0.01291269063949585,
            #                                 0.0009704752010293305,
            #                                 0.008728829212486744,
            #                                 0.06216021999716759,
            #                                 -0.05023123696446419,
            #                                 -0.01455635018646717,
            #                                 -0.024530375376343727,
            #                                 -0.009363879449665546,
            #                                 -0.000591468473430723,
            #                                 0.008473563939332962,
            #                                 -0.03606089949607849,
            #                                 -0.010422296822071075,
            #                                 -0.027742983773350716,
            #                                 0.05573500692844391,
            #                                 0.014182791113853455,
            #                                 -0.018379103392362595,
            #                                 -0.04094206914305687,
            #                                 0.02327272668480873,
            #                                 -0.034267812967300415,
            #                                 0.006998005788773298,
            #                                 0.011617685668170452,
            #                                 -0.04370640590786934,
            #                                 0.006294469349086285,
            #                                 -0.01588871143758297,
            #                                 -0.015577411279082298,
            #                                 -0.03232530876994133,
            #                                 -0.019674109295010567,
            #                                 0.008828445337712765,
            #                                 0.00799416285008192,
            #                                 -0.014867649413645267,
            #                                 -0.02274974435567856,
            #                                 -0.00910238828510046,
            #                                 0.0053948150016367435,
            #                                 0.0010856558801606297,
            #                                 0.010658884420990944,
            #                                 0.02981000952422619,
            #                                 -0.004856267478317022,
            #                                 0.03454175963997841,
            #                                 0.008361496031284332,
            #                                 -0.01632452942430973,
            #                                 -0.003701347392052412,
            #                                 0.0098246019333601,
            #                                 0.024206625297665596,
            #                                 -0.0037667201831936836,
            #                                 0.03857619687914848,
            #                                 0.011667493730783463,
            #                                 -0.00023833844170439988,
            #                                 -0.010110997594892979,
            #                                 -0.002533975290134549,
            #                             ],
            #                             "k": 10,
            #                         }
            #                     }
            #                 },
            #                 {"match": {"chunkText": "chi è Ousmane Sonko?"}},
            #             ]
            #         }
            #     },
            #     "post_filter": {
            #         "bool": {
            #             "filter": [
            #                 {"term": {"user_id.keyword": 666}},
            #                 {"term": {"chat_id.keyword": 336}},
            #             ]
            #         }
            #     },
            # }

            response = open_search_client.search(
                body=open_search_query, index=self.uploaded_documents_index
            )

            for row in response["hits"]["hits"]:
                document_source = row.get("_source")
                filename = document_source.get("filename")
                file_extension = document_source.get("file_extension")
                score = row.get("_score", 0)
                uploaded_documents = document_source.get("chunks", [])

                for item in uploaded_documents:
                    document = Document(
                        item,
                        metadata={
                            "document_id": filename,
                            "filename": filename,
                            "file_extension": file_extension,
                            "score": score,
                        },
                    )
                    documents.append(document)

        return documents
